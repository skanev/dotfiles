#!/bin/bash
alias reload_aliases="source ~/.bash/aliases"
alias aliases="vim ~/.bash/aliases && reload_aliases"
alias localrc="vim ~/.localrc && source ~/.localrc"

# Rudimentary catalog of my notes on commands / shortcuts
alias ka="vim ~/dev/dotfiles/knowledge.txt"
alias k="cat ~/dev/dotfiles/knowledge.txt | fzf"

alias ll="ls -l"
alias tmux="tmux -2"

alias code="code ./"

alias rake="noglob rake"
alias rdm="bundle exec rake db:migrate"
alias rdtp="bundle exec rake db:test:prepare"
alias rdmr="bundle exec rake db:migrate:reset"
alias rrs="bundle exec rake spec"
alias rc="bundle exec rake cucumber"

alias rg="rails generate"
alias rmig="rails generate migration"

alias g="git"
alias gg='git graph'
alias gf="git fetch"
alias gs="scmpuff_status"
alias ga="git add"
alias gd="git diff"
alias gds="git diff --cached"
alias gc="git commit"
alias no-hooks-gc="UNHOOK='ruby-diff-style.pre-commit' gc"
alias gca="git commit --amend"
alias gbl="git blame -w -M -C"
alias gcp="git cherry-pick"

alias gco="git checkout"
alias gcof="git branch --all | fzf | sed 's+remotes/origin/++g' | xargs git checkout"
alias gps="git push"
alias gpsf="git push --force-with-lease"
alias gpsu="git rev-parse --abbrev-ref HEAD | xargs git push -u origin" 
alias gpl="git pull"
alias gplr="git pull --rebase"
alias grho="gf && git rev-parse --abbrev-ref HEAD | xargs -I {1} git reset --hard origin/{1}"

alias grm="git rebase origin/master"
alias grim="git rebase -i origin/master"
alias grc="git rebase --continue"
alias grs="git rebase --skip"
alias gr10="git rebase --autosquash -i HEAD~10"

alias gst="git stash"
alias gsta="git stash apply"
alias gstc="git stash clear"
alias gstp="git stash pop"

alias hpc="hub pr checkout"

alias t="tmux"
alias ta="tmux-attach-current"
alias tat="tmux attach"

alias m="make"
alias be="bundle exec"
alias vii="gvim --remote-silent"
alias gemopen="VIM_COLORSCHEME=blackboard BUNDLER_EDITOR=mvim bundle open"

alias ree="RUBY_HEAP_MIN_SLOTS=1000000 RUBY_HEAP_SLOTS_INCREMENT=1000000 RUBY_HEAP_SLOTS_GROWTH_FACTOR=1 RUBY_GC_MALLOC_LIMIT=1000000000 RUBY_HEAP_FREE_MIN=500000"

alias spj="ree bundle exec xvfb-run specjour --rsync-port=8991"
alias spjs="ree bundle exec xvfb-run specjour spec --rsync-port=8991"
alias spjf="ree bundle exec xvfb-run specjour features --rsync-port=8991"
alias spp="bundle exec specjour prepare --rsync-port=8991"

alias catchup="gf && gco master && gpl && bin/install && rake db:migrate db:test:prepare"
alias action-tail='tail -f log/development.log  | grep "Started\|Processing by\|Parameters\|Completed\|Render\|DEBUG"'

grep-in-project () {
  git --no-pager grep "$@"
  grep -RI "$@" `bundle show --paths`
}

note () {
    timestamp=$(date "+%Y-%m-%d-%H-%M")
    mvim -c "colorscheme solarized" "$timestamp-$1.md"
}
alias notes="mvim -c 'colorscheme solarized' -c 'NERDTree'"

note-push () {
    timestamp=$(date "+%Y-%m-%d-%H-%M")
    ga * && gc -m "Notes $timestamp" && gps
}

alias clj="rlwrap --quote-characters=\"'\" --command clojure clj"
alias gist="gist -o"

if [[ -n $ZSH_NAME ]]; then
    alias -g RERR="2>&1"
fi
